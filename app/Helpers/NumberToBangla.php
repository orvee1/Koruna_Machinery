<?php

namespace App\Helpers;

class NumberToBangla
{
    protected static $words = [
        '', 'এক', 'দুই', 'তিন', 'চার', 'পাঁচ', 'ছয়', 'সাত', 'আট', 'নয়',
        'দশ', 'এগারো', 'বারো', 'তেরো', 'চৌদ্দ', 'পনেরো', 'ষোল', 'সতেরো', 'আঠারো', 'উনিশ',
        'বিশ', 'একুশ', 'বাইশ', 'তেইশ', 'চব্বিশ', 'পঁচিশ', 'ছাব্বিশ', 'সাতাশ', 'আটাশ', 'ঊনত্রিশ',
        'ত্রিশ', 'একত্রিশ', 'বত্রিশ', 'তেত্রিশ', 'চৌত্রিশ', 'পঁইত্রিশ', 'ছত্রিশ', 'সাইত্রিশ', 'আটত্রিশ', 'ঊনচল্লিশ',
        'চল্লিশ', 'একচল্লিশ', 'বিয়াল্লিশ', 'তেতাল্লিশ', 'চুয়াল্লিশ', 'পঁইচল্লিশ', 'ছেচল্লিশ', 'সাতচল্লিশ', 'আটচল্লিশ', 'ঊনপঞ্চাশ',
        'পঞ্চাশ', 'একান্ন', 'বাহান্ন', 'তিপ্পান্ন', 'চুয়ান্ন', 'পঁচান্ন', 'ছাপ্পান্ন', 'সাতান্ন', 'আটান্ন', 'ঊনষাট',
        'ষাট', 'একষট্টি', 'বাষট্টি', 'তেষট্টি', 'চৌষট্টি', 'পঁইষট্টি', 'ছেষট্টি', 'সাতষট্টি', 'আটষট্টি', 'ঊনসত্তর',
        'সত্তর', 'একাত্তর', 'বাহাত্তর', 'তেহাত্তর', 'চুয়াত্তর', 'পঁচাত্তর', 'ছিয়াত্তর', 'সাতাত্তর', 'আটাত্তর', 'ঊনআশি',
        'আশি', 'একাশি', 'বিরাশি', 'তিরাশি', 'চুরাশি', 'পঁচাশি', 'ছিয়াশি', 'সাতাশি', 'আটাশি', 'ঊননব্বই',
        'নব্বই', 'একানব্বই', 'বিরানব্বই', 'তিরানব্বই', 'চুরানব্বই', 'পঁচানব্বই', 'ছিয়ানব্বই', 'সাতানব্বই', 'আটানব্বই', 'নিরানব্বই'
    ];

    protected static $units = ['কোটি', 'লক্ষ', 'হাজার', 'শত', ''];
    protected static $divisors = [10000000, 100000, 1000, 100, 1];

    public static function convert($amount)
    {
        $amount = number_format((float) $amount, 2, '.', '');
        [$tk, $poisa] = explode('.', $amount);

        $result = self::convertNumber((int) $tk) . ' টাকা';

        if ((int)$poisa > 0) {
            $result .= ' এবং ' . self::convertNumber((int) $poisa) . ' পয়সা';
        }

        return trim($result) . ' মাত্র';
    }

    protected static function convertNumber($number)
    {
        if ($number == 0) return 'শূন্য';

        $output = '';

        foreach (self::$divisors as $i => $divisor) {
            $quotient = intval($number / $divisor);
            $number = $number % $divisor;
            if ($quotient > 0) {
                $output .= self::$words[$quotient] . ' ' . self::$units[$i] . ' ';
            }
        }

        return trim($output);
    }
}
